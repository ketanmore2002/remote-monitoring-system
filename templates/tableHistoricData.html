{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Historic Table Data</title>
  {% comment %} <link rel="stylesheet" href="styles.css"> {% endcomment %}
  <link rel="stylesheet" href="{% static 'styles.css' %}">
  <!-- Load plotly.js into the DOM -->
  {% comment %} <script src="plotly-2.20.0.min.js" charset="utf-8"></script> {% endcomment %}
  <script src="{% static 'plotly-2.20.0.min.js' %}" charset="utf-8"></script>
</head>
<body>
    <div class="sidebar">
      <br>
      <img class="logo" src="{% static 'images/logo.jpg' %}" alt="Icon">
      <br>
      <a href="/">Home</a>
      <a href="/site_details">Site Details</a>
      <a href="/register_pump">Pump Registration</a>
      <a href="/logout">Log Out</a>
       <!-- <footer><img src="solarPump.png"> </footer> -->
        </div>
            <div class="row" >
                <div class="nav">
                  <table class="navbartable">
                    <tr>
                      <th></th>
                      <th></th>
                      <th></th>
                      <th></th>
                      <th></th>
                      <th><h1>Solar Water Pump Remote Monitoring System</h1></th>
                      <th></th>
                      <th>Login By :  <br>{{request.user.username}}<br> {{request.user.last_login}} </th>
                  </tr>
                </table>
             
                </div>
            </div>
            <div class="row">
                <div class="testingLeftHalf">  
                                                   
                  </div>
                  <div class="historicRightHalf"> 
                    <table>
                      <h2 class="historicTitle">Historic Data</h2>
                        <tr>
                          <th></th>  
                          <th></th>
                          <th>RMS ID</th>
                          <th><select class="RMSIDInput" placeholder="RMS ID" id="rms-selector">
                            <option aria-placeholder="" disabled selected>Select Option</option>
                            {% for i in data2 %}
                            <option aria-placeholder="RMSID" id = "{{i.rms}}">{{i.rms}}</option>
                            {% endfor %}
                          </select></th>
                          <th>From</th>
                          <th><input type="date" class="RMSIDInput" id="start_date"></th>
                          <th>To</th>
                          <th><input type="date" class="RMSIDInput" id="stop_date"></th>
                          <th></th>
                          <th></th>
                        </tr>
                        <tr>
                          <th></th>
                          <th></th>
                          <th></th>
                          <th></th>
                          <th colspan="3">
                        <div class="btn-group">
                          <a id="btn-search"><button>Search</button></a>
                          <button>Graph</button>
                          <button class="table">Table</button></th>
                        </div>
                          <th></th>
                          <th></th>
                          <th></th>
                          <th></th>
                        </tr>
                       <!-- <tr>
                        <th>
                          <div class="btn-group">
                          <button>Year</button>
                          <button>Month</button>
                          <button>Week</button>
                          </div>
                      </th>
                    </tr>-->
                  </table> 
                  <table class="tableData">
                    <tr>
                      <th>Date</th>
                      <th>Start Time</th>
                      <th>End Time</th>
                      <th>Run Time</th>
                      <th>LPD</th>
                    </tr>
                    {% for i in data %}
                    <tr>
                      <td>{{i.date}}</td>
                      <td>{{i.start_time}}</td>
                      <td>{{i.stop_time}}</td>
                      <td>{{i.run_time_today }}</td>
                      <td>{{i.cumulative_lpd }}</td>
                    </tr>
                    {% endfor %}
              </table>
                </div>
            </div>          
            <script src="{% static 'home.js' %}"></script>
          </table>
     </form>
    </section>
    </div>
    <script>
document.getElementById("btn-search").addEventListener("click", function() {
  // Get selected RMS value from dropdown
  const rmsSelector = document.getElementById("rms-selector");
  const selectedRMS = rmsSelector.options[rmsSelector.selectedIndex].value;
  
  // Get start_date and stop_date input values
  const startDate = document.getElementById("start_date").value;
  const stopDate = document.getElementById("stop_date").value;
  
  // Construct the URL
  const baseUrl = "/history_table/search/";
  const url = `${baseUrl}${selectedRMS}/${startDate}/${stopDate}`;
  
  // Redirect to the constructed URL
  window.location.href = url;
});
</script>
</body>
</html>